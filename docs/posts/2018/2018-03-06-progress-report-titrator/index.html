<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2018-03-06">

<title>robertslab.info - Progress Report - Titrator</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">robertslab.info</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bi-hdd-network" role="button" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-hdd-network" role="img">
</i> 
 <span class="menu-text"></span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-bi-hdd-network">    
        <li>
    <a class="dropdown-item" href="http://raven.fish.washington.edu:8787">
 <span class="dropdown-text">raven</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://gannet.fish.washington.edu">
 <span class="dropdown-text">gannet</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bi-journal-code" role="button" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-journal-code" role="img">
</i> 
 <span class="menu-text"></span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-bi-journal-code">    
        <li>
    <a class="dropdown-item" href="https://robertslab.github.io/sams-notebook/">
 <span class="dropdown-text">sam</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://sr320.github.io">
 <span class="dropdown-text">steven</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bi-github" role="button" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-bi-github">    
        <li>
    <a class="dropdown-item" href="https://github.com/RobertsLab">
 <span class="dropdown-text">Lab Organization</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://github.com/RobertsLab/lab-website">
 <span class="dropdown-text">Edit Roberts Lab website</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item compact">
    <a class="nav-link" href="https://calendar.google.com/calendar/embed?src=mrc305@gmail.com&amp;ctz=America/Vancouver"><i class="bi bi-calendar-week" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Progress Report - Titrator</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Miscellaneous</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">March 6, 2018</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#the-wrap-up" id="toc-the-wrap-up" class="nav-link active" data-scroll-target="#the-wrap-up">The Wrap Up</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p>I’ll begin this entry with a TL;DR (becuase it’s definitely a very long read):</p>
<ul>
<li><p>Sample weight (i.e.&nbsp;volume) appears to have an effect on total alkalinity (TA) determination, despite the fact that sample weight is taken into account when calculating TA.</p></li>
<li><p>Replicates are relatively consistent.</p></li>
<li><p>Our TA measurements of CO2 Reference Materials (CRMs) do not match TA info supplied with CRMs.</p></li>
<li><p>Conclusions?</p>
<ul>
<li><p>The only thing that actually matters is consistent replicates.</p></li>
<li><p>Use 50g (i.e.&nbsp;50mL) sample weights - will greatly conserve reagents (CRMs, acid)</p></li>
<li><p>Calculate offset from CRMs or just report our TA measurements and the corresponding CRM TA value(s)?</p></li>
<li><p>Ask Hollie Putnam what she thinks.</p></li>
</ul></li>
</ul>
<p>With that out of the way, here’s a fairly lengthy overview of what has been done to date with the titrator. In essence, this is a cumulative notebook entry of all the entries I should have been doing on a daily/weekly basis (I actually feel much shame for neglecting this - it’s a terrible practice and an even worse example for other lab members).</p>
<section id="teaser-there-are-graphs" class="level4">
<h4 class="anchored" data-anchor-id="teaser-there-are-graphs">Teaser: there are graphs!</h4>
<p>Anyway, I’ve spent a lot of time getting our titrator, <a href="https://github.com/RobertsLab/titrator/tree/master/protocols">protocols</a>, and <a href="https://github.com/RobertsLab/titrator/tree/master/scripts">scripts</a> to a point where we can not only begin collecting real data, but also actually analyze the data in a semi-automated way.</p>
<p>More recently, I’ve finally started taking some measurements to assess the consistency of the actual titrator and stumbled across an interesting observation that may (may not) have an impact on how we proceed with sample/data handling.</p>
<hr>
</section>
<section id="protocols" class="level4">
<h4 class="anchored" data-anchor-id="protocols">Protocols</h4>
<p><a href="https://github.com/RobertsLab/titrator/blob/master/protocols/titrator_SOP.md">Titrator SOP</a> is the primary protocol that encompasses setting up/shutting down the titrator, use of the LabX software needed for recording/exporting data from the titrator, and how to implement the necessary scripts to handle the exported data is still in early stages.</p>
<p>In theory, the SOP should be rather straightforward, but due to the sensitivity involved with these measurements, the SOP needs to carefully address how to set things up properly, provide a means for documenting startup/shutdown procedures, and provide troubleshooting assistance (e.g.&nbsp;how to empty/remove burette if/when air bubbles develop).</p>
<p>Overall, it’s a bit of a beast, albeit and important one, but I’ve put it on the back burner in order to focus my efforts/time on getting to the point of being able to collect data from the titrator and feel confident that we’re getting good readings.</p>
<p>Once I get to that point and am able to begin running samples, I’ll be able to dedicate more time to fleshing out the SOP, including adding pictures of all the components.</p>
<hr>
</section>
<section id="scripts" class="level4">
<h4 class="anchored" data-anchor-id="scripts">Scripts</h4>
<p><a href="https://github.com/RobertsLab/titrator/blob/master/scripts/parsing_TA_output.R">parsing_TA_output.R</a> is the script that has consumed the majority of my titrator-related time in the last couple of weeks. It is fully functional (it only requires manual entry of the exported LabX data file location). However, I’m hoping to eventually automate this as well - i.e.&nbsp;when new LabX export file appears, this script will execute. I won’t be spending much time on this aspect of the script until I</p>
<p>This has been my highest priority. Without having this script in a usable state, it has been a MAJOR slog to manually retrieve the appropriate data necessary to use in TA determination.</p>
<p>This also has been my biggest challenge with the titrator process. Here are just some of the hurdles I’ve had to deal with in putting this script together:</p>
<ul>
<li><p>“learning” R</p></li>
<li><p>handling “dynamic” titrator output data</p>
<ul>
<li><p>this is not an easy task for a non-programmer!</p></li>
<li><p>the output data is of differing numbers of rows from sample to sample, so the script had to be able to handle this aspect automatically</p></li>
<li><p>making the script “flexible” (i.e.&nbsp;no “magic numbers”) to handle any number of samples without the user having to manually modify the script</p></li>
<li><p>making th script “flexible” by operating on column names instead of column numbers, since column numbers were/are not constant, depending on changes to the script</p></li>
</ul></li>
<li><p>calculations resulting from two-part titration</p>
<ul>
<li>still not sure if I ever would’ve figured this out if I hadn’t taken the intro computer science class at UW a couple of years ago!</li>
</ul></li>
</ul>
<p>Despite all of this, I also feel like it’s one of my biggest accomplishments! It’s super satisfying to have this script functioning with virtually no user input required!</p>
<p><a href="https://github.com/RobertsLab/titrator/blob/master/scripts/pH_calibration_check.R">pH_calibration_check.R</a> is still a work in progess, but is easily usable. Currently, it still has some hard-coded values (row numbers) in it for parsing data, but that should be easy to fix after what I went through with the TA parsing script!</p>
<p>Eventually, these two scripts will work in tandem, with the <code>pH_calibration_check</code> script exporting data to a daily “log” file, which the <code>parsing_TA_output</code> script will use to read-in the necessary pH data.</p>
<p><a href="https://github.com/RobertsLab/titrator/blob/master/scripts/TA_calculation.R">TA_calculation.R</a> will calculate the TA values, but currently requires fully manual data entry. It desperately needs attention and will likely be my primary focus in the immediate future, due to the need to have TA values for actual samples, as well as daily quality control checks (e.g.&nbsp;verify CRM measurements look OK before measuring actual samples).</p>
<hr>
</section>
<section id="measurements" class="level4">
<h4 class="anchored" data-anchor-id="measurements">Measurements</h4>
<section id="consistency-checks-with-instant-ocean" class="level5">
<h5 class="anchored" data-anchor-id="consistency-checks-with-instant-ocean">Consistency checks with Instant Ocean</h5>
<section id="instant-ocean-tests" class="level6">
<h6 class="anchored" data-anchor-id="instant-ocean-tests">Instant Ocean Tests</h6>
<p>I ran nine replicates of Instant Ocean (36g/L in deionized water) at two different samples weights/volume (50g, 75g) to make sure the titrator was producing consistent results.</p>
<p>Here’s the R Studio Project folder with all the data/scripts used to gather the data and produce the plots:</p>
<ul>
<li><a href="https://owl.fish.washington.edu/Athaliana/20180301_titrator_instant_ocean_tests/">20180301_titrator_instant_ocean_tests</a></li>
</ul>
<p>TA values were determined using the <code>seacarb</code> R package. I used a salinity of 35 (<code>seacarb</code> default value?), but this has not been determined for this batch of Instant Ocean.</p>
<p><img src="https://owl.fish.washington.edu/Athaliana/20180301_titrator_instant_ocean_tests/20180301_titrator_instant_ocean_volumes_plot.png" class="img-fluid"></p>


Sample Volume Mean TA Standard Deviation
<table>
<tbody><tr></tr>
</tbody><tbody>
<tr>
<td>
50mL
</td>
<td>
669.4
</td>
<td>
11.14
</td>
</tr>
<tr>
<td>
75mL
</td>
<td>
645.0
</td>
<td>
11.96
</td>
</tr>
</tbody>

</table>
<p>The first thing I noticed was the low TA values when using Instant Ocean. I expected these to be more similar to sea water, but the Instant Ocean hasn’t been aerated, so maybe that could account for the low TA values. Regardless, this shouldn’t be too much of an issue, since I only wanted to use this to see if we were getting consistent measurements.</p>
<p>The second thing I noticed was the difference in TA values between the 50mL and 75mL samples. This is/was odd, as sample weight is taken into account with the <code>seacarb</code> package.</p>
<p>So, I decided to explore this a bit further, using the CRMs that we have. I felt that this would provide more informative data regarding measurement accuracy (i.e.&nbsp;do our measurements match a known value?), in addition to further evaluation of the effects of sample volume on TA determination.</p>
</section>
</section>
<section id="consistency-checks-with-crms" class="level5">
<h5 class="anchored" data-anchor-id="consistency-checks-with-crms">Consistency checks with CRMs</h5>
<section id="crm-tests" class="level6">
<h6 class="anchored" data-anchor-id="crm-tests">CRM Tests</h6>
<p>I ran five replicates of [CRM Batch 168 (PDF)(https://github.com/RobertsLab/titrator/blob/master/data/crm_certifications/Batch168.pdf) at three different sample weights/volume (50g, 75g, 100g) to make sure the titrator was producing consistent results and evaulate how accurate our measurements are.</p>
<p>Here’s the R Studio Project folder with all the data/scripts used to gather the data and produce the plots:</p>
<ul>
<li><a href="https://owl.fish.washington.edu/Athaliana/20180305_titrator_crm_tests/">20180305_titrator_crm_tests</a></li>
</ul>
<p>Here’s a bunch of graphs to consider:</p>
<p><img src="https://owl.fish.washington.edu/Athaliana/20180305_titrator_crm_tests/20180305_titrator_crm_50mLvs75mLvs100mL_TA_plot.png" class="img-fluid"></p>
<p><img src="https://owl.fish.washington.edu/Athaliana/20180305_titrator_crm_tests/20180305_titrator_crm_50mL_weight_vs_TA_plot.png" class="img-fluid"></p>
<p><img src="https://owl.fish.washington.edu/Athaliana/20180305_titrator_crm_tests/20180305_titrator_crm_75mL_weight_vs_TA_plot.png" class="img-fluid"></p>
<p><img src="https://owl.fish.washington.edu/Athaliana/20180305_titrator_crm_tests/20180305_titrator_crm_100mL_weight_vs_TA_plot.png" class="img-fluid"></p>


Sample Mean TA Standard Deviation
<table>
<tbody><tr></tr>
</tbody><tbody>
<tr>
<td>
CRM 168
</td>
<td>
2071.47
</td>
<td>
NA
</td>
</tr>
<tr>
<td>
50mL
</td>
<td>
2259.66
</td>
<td>
7.35
</td>
</tr>
<tr>
<td>
75mL
</td>
<td>
2236.22
</td>
<td>
19.96
</td>
</tr>
<tr>
<td>
100mL
</td>
<td>
2226.73
</td>
<td>
14.49
</td>
</tr>
</tbody>

</table>
<p>First thing to notice is that all sample measurements, regardless of volume, produce a TA value that is ~10% higher than what the CRM is certified to be. I’ve previously discussed this with Hollie and she’s indicated that there are two options:</p>
<ol type="1">
<li><p>Calculate an offset relative to what the CRM is supposed to be and apply this offset to any sample measurements.</p></li>
<li><p>Do not determine offset and just report calculated values, while providing CRM info.</p></li>
</ol>
<p>The next thing that I noticed is the 50mL (g) samples produced the most consistent measurements.</p>
<p>There also seems to be a pattern where fluctuations in TA values across replicates are mirrored by changes in weight for each corresponding replicate.</p>
<p>Finally, although it isn’t explicitly addressed, there is a time element in play here. As sample number increases, the longer those samples sat in the sample changer before titration. Oddly, it appears that there could be an effect on samples as they sit (e.g.&nbsp;sample evaporation prior to titration) when one considers the 75mL and 100mL samples, but both of those result in opposing trends, while the 50mL samples do not seem to suffer from any sort of time-related changes…</p>
<hr>
</section>
</section>
</section>
<section id="the-wrap-up" class="level3">
<h3 class="anchored" data-anchor-id="the-wrap-up">The Wrap Up</h3>
<p>Whew! We made it! I’ll wait to get some feedback from lab members and Hollie before cranking through all of Hollie’s samples, but I feel pretty good about proceeding with a 50mL sample volume. If we decide to calculate an offset later on, it should only be a relatively minor tweak to our script.</p>
<p>Next up, figure out a way to pull out all of <a href="https://github.com/hputnam/project_juvenile_geoduck_OA/blob/master/RAnalysis/Data/SW_Chem_Juvenile_Geoduck.csv">Hollie’s salinity data for the samples I’m going to measure</a> and incorporate that into the <a href="https://github.com/RobertsLab/titrator/blob/master/scripts/TA_calculation.R">TA_calculation.R</a> script.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>