<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2021-05-13">

<title>robertslab.info - Genome Submission - Validation of Olurida_v081.fa and Annotated GFFs Prior to Submission to NCBI</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">robertslab.info</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bi-hdd-network" role="button" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-hdd-network" role="img">
</i> 
 <span class="menu-text"></span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-bi-hdd-network">    
        <li>
    <a class="dropdown-item" href="http://raven.fish.washington.edu:8787">
 <span class="dropdown-text">raven</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://gannet.fish.washington.edu">
 <span class="dropdown-text">gannet</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bi-journal-code" role="button" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-journal-code" role="img">
</i> 
 <span class="menu-text"></span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-bi-journal-code">    
        <li>
    <a class="dropdown-item" href="https://robertslab.github.io/sams-notebook/">
 <span class="dropdown-text">sam</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://sr320.github.io">
 <span class="dropdown-text">steven</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bi-github" role="button" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-bi-github">    
        <li>
    <a class="dropdown-item" href="https://github.com/RobertsLab">
 <span class="dropdown-text">Lab Organization</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://github.com/RobertsLab/lab-website">
 <span class="dropdown-text">Edit Roberts Lab website</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item compact">
    <a class="nav-link" href="https://calendar.google.com/calendar/embed?src=mrc305@gmail.com&amp;ctz=America/Vancouver"><i class="bi bi-calendar-week" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Genome Submission - Validation of Olurida_v081.fa and Annotated GFFs Prior to Submission to NCBI</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Olympia Oyster Genome Assembly</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">May 13, 2021</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#discrepancy-report" id="toc-discrepancy-report" class="nav-link active" data-scroll-target="#discrepancy-report">Discrepancy report:</a></li>
  <li><a href="#validation-report" id="toc-validation-report" class="nav-link" data-scroll-target="#validation-report">Validation report</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p><a href="https://github.com/RobertsLab/resources/issues/1159">Per this GitHub Issue</a>, Steven has asked to get our <a href="http://en.wikipedia.org/wiki/Pacific_oyster"><em>Ostrea lurida</em> (Olympia oyster)</a> genome assembly (<code>Olurida_v081.fa</code>) submitted to NCBI with annotations. The first step in the submission process is to use the NCBI <code>table2asn_GFF</code> software to validate the FastA assembly, as well as the GFF annotations file. Once the software has been run, it will point out any errors which need to be corrected prior to submission.</p>
<p>The validation was run on my local computer in the following Jupyter Notebook:</p>
<p>Jupyter Notebook (GitHub):</p>
<ul>
<li><a href="https://github.com/RobertsLab/code/blob/master/notebooks/sam/20210513_olur_NCBI_genome-submission-prep.ipynb">20210513_olur_NCBI_genome-submission-prep.ipynb</a></li>
</ul>
<p>Jupyter Notebook (NBviewer):</p>
<ul>
<li><a href="https://nbviewer.jupyter.org/github/RobertsLab/code/blob/master/notebooks/sam/20210513_olur_NCBI_genome-submission-prep.ipynb">20210513_olur_NCBI_genome-submission-prep.ipynb</a></li>
</ul>
<iframe src="https://nbviewer.jupyter.org/github/RobertsLab/code/blob/master/notebooks/sam/20210513_olur_NCBI_genome-submission-prep.ipynb" width="100%" height="2000" scrolling="yes">
</iframe>
<hr>
<section id="results" class="level4">
<h4 class="anchored" data-anchor-id="results">RESULTS</h4>
<p>Output folder:</p>
<ul>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20210513_olur_NCBI_genome-submission-prep/">20210513_olur_NCBI_genome-submission-prep/</a></p>
<ul>
<li><p>Discrepancy Report (text; 46MB)</p>
<ul>
<li><a href="https://gannet.fish.washington.edu/Atumefaciens/20210513_olur_NCBI_genome-submission-prep/20210513_Olurida-v081.dr">20210513_olur_NCBI_genome-submission-prep/20210513_Olurida-v081.dr</a></li>
</ul></li>
<li><p>Validation Report (text; 867B)</p>
<ul>
<li><a href="https://gannet.fish.washington.edu/Atumefaciens/20210513_olur_NCBI_genome-submission-prep/20210513_Olurida-v081.stats">20210513_olur_NCBI_genome-submission-prep/20210513_Olurida-v081.stats</a></li>
</ul></li>
</ul></li>
</ul>
<p>Alrighty, let’s take a look at the results.</p>
<hr>
</section>
<section id="discrepancy-report" class="level3">
<h3 class="anchored" data-anchor-id="discrepancy-report">Discrepancy report:</h3>
<pre><code>Discrepancy Report Results

Summary
COUNT_NUCLEOTIDES: 159429 nucleotide Bioseqs are present
LONG_NO_ANNOTATION: 46845 bioseqs are longer than 5000nt and have no features
NO_ANNOTATION: 133211 bioseqs have no features
GAPS: 114914 sequences contain gaps
LOW_QUALITY_REGION: 809 sequences contain low quality region
FEATURE_COUNT: CDS: 32210 present
FEATURE_COUNT: gene: 32210 present
FEATURE_COUNT: mRNA: 32210 present
PROTEIN_NAMES: All proteins have same name "hypothetical protein"
BAD_GENE_STRAND: 3 feature locations conflict with gene location strands
FATAL: CONTAINED_CDS: 10 coding regions are completely contained in another coding region, but on the opposite strand.
FEATURE_LOCATION_CONFLICT: 16978 features have inconsistent gene locations.
FATAL: BACTERIAL_JOINED_FEATURES_NO_EXCEPTION: 29207 coding regions with joined locations have no exceptions
SHORT_INTRON: 726 introns are shorter than 10 nt
FEATURE_LIST: Feature List

Detailed Report</code></pre>
<p><a href="https://www.ncbi.nlm.nih.gov/genbank/asndisc/#evaluating_the_output">Here’s the NCBI resource guide to the understanding the Discrepancy Report.</a> as well as a <a href="https://www.ncbi.nlm.nih.gov/genbank/new_asndisc_examples/">guide to common errors</a>.</p>
<p>We see that there are two lines beginning with <code>FATAL</code>, but they’re actually not a big deal:</p>
<ul>
<li><p><code>FATAL: BACTERIAL_JOINED_FEATURES_NO_EXCEPTION</code>: This can be ignored, as it only applies to prokaryotes.</p></li>
<li><p><code>FATAL: CONTAINED_CDS</code>: These will require inspection and confirmation that the annotations are indeed correct and/or fixed.</p></li>
</ul>
<p>Here are other problems which will need to be addressed:</p>
<ul>
<li><p><code>LOW_QUALITY_REGION</code>: Indicates stretches of N’s. Will need to remove N’s and replace with gap “feature”.</p></li>
<li><p><code>BAD_GENE_STRAND</code>: Not sure whether or not this is critical, as it’s not documented in either of those links above. I’ll have to contact NCBI regarding this.</p></li>
<li><p><code>FEATURE_LOCATION_CONFLICT</code>: Not sure whether or not this is critical, as it’s not documented in either of those links above. I’ll have to contact NCBI regarding this.</p></li>
<li><p><code>SHORT_INTRON</code>: Not sure whether or not this is critical, as it’s not documented in either of those links above. I’ll have to contact NCBI regarding this.</p></li>
</ul>
<hr>
</section>
<section id="validation-report" class="level3">
<h3 class="anchored" data-anchor-id="validation-report">Validation report</h3>
<pre><code>Total messages:     293302

=================================================================
35926 WARNING-level messages exist

SEQ_INST.TerminalGap:   2
SEQ_INST.LeadingX:  1
SEQ_FEAT.NotSpliceConsensusDonor:   12488
SEQ_FEAT.NotSpliceConsensusAcceptor:    10811
SEQ_FEAT.IntervalBeginsOrEndsInGap: 72
SEQ_FEAT.ShortExon: 1182
SEQ_FEAT.PartialProblemNotSpliceConsensus3Prime:    6154
SEQ_FEAT.PartialProblemNotSpliceConsensus5Prime:    5214
SEQ_FEAT.PartialProblem5Prime:  2

=================================================================
257376 ERROR-level messages exist

SEQ_INST.ShortSeq:  2
SEQ_DESCR.BioSourceMissing: 26218
SEQ_DESCR.NoPubFound:   1
SEQ_DESCR.NoSourceDescriptor:   1
GENERIC.MissingPubRequirement:  1
SEQ_FEAT.IllegalDbXref: 230426
SEQ_FEAT.FeatureBeginsOrEndsInGap:  1
SEQ_FEAT.ShortIntron:   726

=================================================================</code></pre>
<p><a href="https://www.ncbi.nlm.nih.gov/genbank/genome_validation/">Here’s the NCBI guide to validation errors</a>. All errors will need to be resolved prior to submission.</p>
<ul>
<li><p><code>SEQ_INST.ShortSeq</code>: This is not documented in the link above. I’ll have to contact NCBI regarding this.</p></li>
<li><p><code>SEQ_DESCR.BioSourceMissing</code>: “Suggestion: Provide an organism name for each sequence in your submission.” Not sure if this needs to be done in the FastA, GFF, or both. Or, maybe it needs to be supllied when running the <code>table2asn_GFF</code> command, using the <code>-j</code> option? Will investigate both files and see which sequences this crops up on, as well as a modified run of the <code>table2asn_GFF</code>.</p></li>
<li><p><code>SEQ_DESCR.NoPubFound</code>: “Suggestion: Include the template when you create the .sqn submission file. You can create a template here: https://submit.ncbi.nlm.nih.gov/genbank/template/submission/ .” I’ll create a template file.</p></li>
<li><p><code>SEQ_DESCR.NoSourceDescriptor</code>: This is not documented in the link above. I’ll have to contact NCBI regarding this. However, I have a sneaking suspicion that this is related to the need for a template file.</p></li>
<li><p><code>GENERIC.MissingPubRequirement</code>: This is not documented in the link above. I’ll have to contact NCBI regarding this. However, I have a sneaking suspicion that this is related to the need for a template file.</p></li>
<li><p><code>SEQ_FEAT.IllegalDbXref</code>: This is not documented in the link above. I’ll have to contact NCBI regarding this. However, it’s likely due to incorrect formatting or invalid database cross reference, according to <a href="https://www.ncbi.nlm.nih.gov/genbank/collab/db_xref/%20">this NCBI DbXref guide</a>.</p></li>
<li><p><code>SEQ_FEAT.FeatureBeginsOrEndsInGap</code>: This is not documented in the link above. I’ll have to contact NCBI regarding this. However, it seems obvious that the problem is that a feature is beginning/ending in a stretch of N’s. Will look at GFF to see what’s happening.</p></li>
<li><p><code>SEQ_FEAT.ShortIntron</code>: This is not documented in the link above. I’ll have to contact NCBI regarding this. However, it’s clear that some introns are considered too short. This was identified in the Discrepancy Report above, but the documentation for that suggests that this might not need to be corrected. But, documentation indicates that all errors in the validation need to be eliminated…</p></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>