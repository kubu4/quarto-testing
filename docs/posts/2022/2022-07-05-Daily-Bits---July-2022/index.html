<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2022-07-05">

<title>robertslab.info - Daily Bits - July 2022</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../..//images/favicon.ico" rel="icon">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">robertslab.info</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bi-hdd-network" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
      <i class="bi bi-hdd-network" role="img">
</i> 
 <span class="menu-text"></span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-bi-hdd-network">    
        <li>
    <a class="dropdown-item" href="http://raven.fish.washington.edu:8787" rel="" target="_blank">
 <span class="dropdown-text">raven</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://gannet.fish.washington.edu" rel="" target="">
 <span class="dropdown-text">gannet</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bi-journal-code" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
      <i class="bi bi-journal-code" role="img">
</i> 
 <span class="menu-text"></span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-bi-journal-code">    
        <li>
    <a class="dropdown-item" href="https://robertslab.github.io/sams-notebook/" rel="" target="">
 <span class="dropdown-text">sam</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://sr320.github.io" rel="" target="">
 <span class="dropdown-text">steven</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bi-github" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
      <i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-bi-github">    
        <li>
    <a class="dropdown-item" href="https://github.com/RobertsLab" rel="" target="">
 <span class="dropdown-text">Lab Organization</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://github.com/RobertsLab/lab-website" rel="" target="">
 <span class="dropdown-text">Edit Roberts Lab website</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item compact">
    <a class="nav-link" href="https://calendar.google.com/calendar/embed?src=mrc305@gmail.com&amp;ctz=America/Vancouver" rel="" target=""><i class="bi bi-calendar-week" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Daily Bits - July 2022</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">2022</div>
                <div class="quarto-category">Daily Bits</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">July 5, 2022</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p>20220727</p>
<ul>
<li>Ran qPCRs using 8 primer sets on Dorothy’s cDNA from yesterday.</li>
</ul>
<hr>
<p>20220726</p>
<ul>
<li>In lab to finish Dorothy’s mussel RNA extraction and reverse transcription.</li>
</ul>
<hr>
<p>20220725</p>
<ul>
<li><p>Read Ch. 7 of “Fresh Banana Leaves” for book club.</p></li>
<li><p>Lab meeting discussing Ch. 7 of “Fresh Banana Leaves.”</p></li>
</ul>
<hr>
<p>20220721</p>
<ul>
<li><p>More testing with <code>EpiDiverse/wgbs</code> and <code>EpiDiverse/snp</code> pipelines (conda environments). This time ran trimming with an additional 5’ 10bp hard trim, per <a href="https://github.com/FelixKrueger/Bismark"><code>Bismark</code></a> recommendations (they actually recommend 8bp).</p></li>
<li><p>Did a <em>lot</em> of reading about Nextflow and trying to get a grasp on how it all works so we might be able to develop our own pipelines and/or feel confident modifying existing pipelines (e.g.&nbsp;modify <code>EpiDiverse/snp</code> pipeline to analyze all BAMs in a directory without the need to explicitly declare how many at run time).</p></li>
</ul>
<hr>
<p>20220720</p>
<ul>
<li>More testing with <code>EpiDiverse/wgbs</code> pipeline. Per <a href="https://github.com/EpiDiverse/wgbs/issues/11">this GitHub Issue</a>, I tried using the conda test profile and things ran smoothly without any errors in the <code>bam_statistics</code> part of the pipeline. Steps:</li>
</ul>
<ol type="1">
<li>Create conda environment:</li>
</ol>
<pre class="shell"><code>conda env create --name epidiverse-wgbs-current -f /home/shared/epidiverse-pipelines/wgbs-current</code></pre>
<ol start="2" type="1">
<li>Activate conda environment:</li>
</ol>
<pre class="shell"><code>conda activate epdiverse-wgbs-current</code></pre>
<ol start="3" type="1">
<li>Run conda test profile:</li>
</ol>
<pre class="shell"><code>NXF_VER=20.07.1 /home/shared/nextflow run /home/shared/epidiverse-pipelines/wgbs-current -profile test,conda</code></pre>
<ul>
<li><p>Did same conda test process for <code>EpiDiverse/snp</code> and it also ran without issue.</p></li>
<li><p>Started adding instructions for using Nextflow EpiDiverse pipelines on Raven and Mox to Roberts Lab Handbook.</p></li>
<li><p>Decided to re-run the <code>EpiDiverse/wgbs</code> pipeline using the conda environment and enable the FastQC process for post-trimming assessment. Will allow me to compare with our previous trimming results and try to determine why our trimming generates different results when passing our FastQs into the <code>EpiDiverse/snp</code> pipeline.</p></li>
</ul>
<hr>
<p>20220719</p>
<ul>
<li>Assisted Dorothy with prep for big RNA extraction from mussel gills. Homogenized 10 control and 10 heat treated gill samples in 1mL RNAzol RT and stored @ -80C. Extraction to happen next Tuesday.</li>
</ul>
<hr>
<p>20220718</p>
<ul>
<li>Ran some more tests of the <code>EpiDiverse/wgbs</code> and <code>EpiDiverse/snp</code> pipelines to compare the Oly trimmed and untrimmed FastQs as inputs.</li>
</ul>
<hr>
<p>20220717</p>
<ul>
<li>Ran some more tests of the <code>EpiDiverse/wgbs</code> and <code>EpiDiverse/snp</code> pipelines to compare the Oly trimmed and untrimmed FastQs as inputs.</li>
</ul>
<hr>
<p>20220716</p>
<ul>
<li>Ran some more tests of the <code>EpiDiverse/wgbs</code> and <code>EpiDiverse/snp</code> pipelines to compare the Oly trimmed and untrimmed FastQs as inputs.</li>
</ul>
<hr>
<p>20220715</p>
<ul>
<li><p>Managed to resolve the <a href="https://github.com/EpiDiverse/wgbs/issues/9"><code>EpiDiverse/wgbs</code> test issue I encountered yesterday</a>. See the link for details (involves binding local directory to Singularity container).</p></li>
<li><p>Successfully ran the <code>EpiDiverse/wgbs</code> pipeline on a subset of the <em>Ostrea lurida</em> BSseq data! Now to test this in the <code>EpiDiverse/snp</code> pipeline to see if output is same as when running Bismark BAMs through the <code>EpiDiverse/snp</code> pipeline…</p></li>
<li><p>Tested Bismark BAMs from different data set (<em>Panopea generosa</em>: https://gannet.fish.washington.edu/seashell/bu-mox/scrubbed/1231/) in <code>EpiDiverse/snp</code> pipeline to see how results compare to the <em>Ostrea lurida</em> Bismark BAMs.</p></li>
</ul>
<hr>
<p>20220714</p>
<ul>
<li><p>Installed Singularity on Raven (required Go, so installed that, too).</p></li>
<li><p>Tried to run <code>EpiDiverse/wgbs</code> test run on Raven, but it failed. See <a href="https://github.com/EpiDiverse/wgbs/issues/9">the GitHub Issue I posted for deets.</a></p></li>
</ul>
<hr>
<p>20220713</p>
<ul>
<li><p>Got response to <a href="https://github.com/EpiDiverse/snp/issues/6">my <code>EpiDiverse/snp</code> GitHub issue</a> regarding the pipeline not processing all BAM files in directory! Will re-ran pipeline and add the <code>--take &lt;INTEGER&gt;</code> parameter to handle all 18 BAM files.</p></li>
<li><p>Fixed <a href="https://github.com/RobertsLab/resources/issues/1490">issue with CEABIGR transcript count stats</a>. Original code assumed that calculations were only performed on input data and did not process newly added data generated by <code>mutate()</code> function. Fixed that by using the <code>-any_of()</code> fucntion to skip a vector of column names. The <code>-</code> preceding the <code>any_of()</code> is the instruction to <em>exclude</em> things entered in the <code>any_of()</code> function.</p></li>
</ul>
<hr>
<p>20220712</p>
<ul>
<li>In lab: walked Dorothy through the basics of RNA isolation (RNAzol and Direct-zol Mini Kit) and quantification (Qubit RNA BR Assay). Processed two fresh mussel ctenidia samples.</li>
</ul>
<hr>
<p>20220711</p>
<ul>
<li><p>Lab meeting: Discussed Ch.6 of Fresh Banana Leaves</p></li>
<li><p>Oyster gene expression meeting: Steven did some plotting of <a href="https://en.wikipedia.org/wiki/Eastern_oyster"><em>Crassostrea virginica</em> (Eastern oyster)</a> transcript count data.</p></li>
<li><p>Nextflow <code>epidiverse/snp</code>: opted to try <a href="https://github.com/RobertsLab/resources/issues/1489#issuecomment-1179224402">a subsetted version of the Olurida_v081 genome and BSseq alignments</a> (GitHub Issue):</p></li>
</ul>
<p>Looks like it’s working (got past the previous hangups on 20220708)!</p>
<pre><code>N E X T F L O W  ~  version 20.07.1
Launching `epidiverse/snp` [sick_hoover] - revision: 9c814703c6 [master]

================================================
E P I D I V E R S E - S N P    P I P E L I N E
================================================
~ version 1.0

input dir     : /home/shared/8TB_HDD_01/sam/data/O_lurida/BSseq/bams/070322-olymerge-snp/
reference     : /home/shared/8TB_HDD_01/sam/data/O_lurida/genomes/Olurida_v081-mergecat98.fa
output dir    : snps
variant calls : enabled
clustering    : enabled

================================================
RUN NAME: sick_hoover

executor &gt;  local (60)
[2c/3853d0] process &gt; SNPS:preprocessing (zr1394_9_s456_trimmed_bismark_bt2.deduplicated)        [100%] 10 of 10 ✔
[90/dea51f] process &gt; SNPS:masking (zr1394_9_s456_trimmed_bismark_bt2.deduplicated - clustering) [100%] 20 of 20 ✔
[8a/ce2b44] process &gt; SNPS:extracting (zr1394_9_s456_trimmed_bismark_bt2.deduplicated)           [100%] 10 of 10 ✔
[01/ef9503] process &gt; SNPS:khmer (zr1394_6_s456_trimmed_bismark_bt2.deduplicated)                [ 40%] 4 of 10
[-        ] process &gt; SNPS:kwip                                                                  -
[-        ] process &gt; SNPS:clustering                                                            -
[83/238cfa] process &gt; SNPS:sorting (zr1394_9_s456_trimmed_bismark_bt2.deduplicated)              [100%] 10 of 10 ✔
[03/1b910d] process &gt; SNPS:freebayes (zr1394_7_s456_trimmed_bismark_bt2.deduplicated)            [  0%] 0 of 10
[-        ] process &gt; SNPS:bcftools                                                              -
[-        ] process &gt; SNPS:plot_vcfstats </code></pre>
<p>Well, well, well! It worked!!</p>
<pre><code>N E X T F L O W  ~  version 20.07.1
Launching `epidiverse/snp` [sick_hoover] - revision: 9c814703c6 [master]

================================================
E P I D I V E R S E - S N P    P I P E L I N E
================================================
~ version 1.0

input dir     : /home/shared/8TB_HDD_01/sam/data/O_lurida/BSseq/bams/070322-olymerge-snp/
reference     : /home/shared/8TB_HDD_01/sam/data/O_lurida/genomes/Olurida_v081-mergecat98.fa
output dir    : snps
variant calls : enabled
clustering    : enabled

================================================
RUN NAME: sick_hoover

executor &gt;  local (92)
[2c/3853d0] process &gt; SNPS:preprocessing (zr1394_9_s456_trimmed_bismark_bt2.deduplicated)        [100%] 10 of 10 ✔
[90/dea51f] process &gt; SNPS:masking (zr1394_9_s456_trimmed_bismark_bt2.deduplicated - clustering) [100%] 20 of 20 ✔
[8a/ce2b44] process &gt; SNPS:extracting (zr1394_9_s456_trimmed_bismark_bt2.deduplicated)           [100%] 10 of 10 ✔
[a4/dc11ce] process &gt; SNPS:khmer (zr1394_9_s456_trimmed_bismark_bt2.deduplicated)                [100%] 10 of 10 ✔
[95/79be9f] process &gt; SNPS:kwip                                                                  [100%] 1 of 1 ✔
[c6/24b89b] process &gt; SNPS:clustering                                                            [100%] 1 of 1 ✔
[83/238cfa] process &gt; SNPS:sorting (zr1394_9_s456_trimmed_bismark_bt2.deduplicated)              [100%] 10 of 10 ✔
[63/2c5bc5] process &gt; SNPS:freebayes (zr1394_9_s456_trimmed_bismark_bt2.deduplicated)            [100%] 10 of 10 ✔
[00/f4af8b] process &gt; SNPS:bcftools (zr1394_9_s456_trimmed_bismark_bt2.deduplicated)             [100%] 10 of 10 ✔
[df/1e78de] process &gt; SNPS:plot_vcfstats (zr1394_9_s456_trimmed_bismark_bt2.deduplicated)        [100%] 10 of 10 ✔

Pipeline execution summary
---------------------------
Name         : sick_hoover
Profile      : docker
Launch dir   : /home/shared/8TB_HDD_01/sam/analyses/20220707-olur-epidiverse
Work dir     : /home/shared/8TB_HDD_01/sam/analyses/20220707-olur-epidiverse/work (cleared)
Status       : success
Error report : -

Completed at: 11-Jul-2022 18:47:04
Duration    : 3h 17m 49s
CPU hours   : 140.1
Succeeded   : 92
</code></pre>
<p>I’ll obviously share this with Steven, but will also see if I can get the original dataset to run on Mox, which has twice the memory available as Raven…</p>
<p>Actually, I glanced at the data and it didn’t really work. It only seems to have analyzed some of the BAMs in the directory! There are 18 BAMs, but it only processed 10 of them.. Odd (and annoying). I’ll re-run to see if it does the same thing.</p>
<hr>
<p>20220710</p>
<ul>
<li><p>Created <code>erne-bs5</code> genome index to attempt full epidiverse pipeline, starting with <code>EpiDiverse/wgbs</code>:</p>
<pre class="shell"><code>/home/shared/erne-2.1.1-linux/bin/erne-create \
--methyl-hash \
--fasta Olurida_v081.fa \
--output-prefix Olurida_v081</code></pre></li>
<li><p>Realized I had experienced previous issues (see this <a href="https://github.com/EpiDiverse/wgbs/issues/5">GitHub Issue</a> and this <a href="https://github.com/EpiDiverse/wgbs/issues/6">GitHub Issue</a>) previously, which is not encouraging.</p>
<p>Tried to run the test protocol for this pipeline “locally” (i.e.&nbsp;offline) using Mox sbatch script. To do so, I’ve downloaded all the of the input files listed in <a href="https://github.com/EpiDiverse/wgbs/blob/master/config/test.config"><code>test.config</code></a>. I’ve also downloaded the Singularity image (<code>singularity pull docker://epidiverse/wgbs:1.0</code>) and changed the <code>nextflow.config</code> file to specify the Singularity image location, like so:</p></li>
</ul>
<pre><code>// -profile singularity
    singularity {
        includeConfig "${baseDir}/config/base.config"
        singularity.enabled = true
        process.container = '/gscratch/srlab/sam/analyses/20220710-olu-epidiverse_wgbs-test/work/singularity/wgbs_1.0.sif'
    }</code></pre>
<p>That seemed like that should be all that was needed, but when I execute the test command (<code>NXF_VER=20.07.1 /gscratch/srlab/programs/nextflow-21.10.6-all run /gscratch/srlab/sam/analyses/20220710-olu-epidiverse_wgbs-test/wgbs-1.0 -profile test,singularity</code>), it fails with this error:</p>
<pre><code>executor &gt;  local (10)
[c4/79070c] process &gt; INDEX:erne_bs5_indexing        [100%] 1 of 1 ✔
[30/202688] process &gt; INDEX:segemehl_indexing        [100%] 1 of 1 ✔
[07/dc2230] process &gt; WGBS:read_trimming (sampleB)   [100%] 8 of 8, failed: 8...
[-        ] process &gt; WGBS:read_merging              -
[-        ] process &gt; WGBS:fastqc                    -
[-        ] process &gt; WGBS:erne_bs5                  -
[-        ] process &gt; WGBS:segemehl                  -
[-        ] process &gt; WGBS:erne_bs5_processing       -
[-        ] process &gt; WGBS:segemehl_processing       -
[-        ] process &gt; WGBS:bam_merging               -
[-        ] process &gt; WGBS:bam_subsetting            -
[-        ] process &gt; WGBS:bam_filtering             -
[-        ] process &gt; WGBS:bam_statistics            -
[-        ] process &gt; CALL:bam_processing            -
[-        ] process &gt; CALL:Picard_MarkDuplicates     -
[-        ] process &gt; CALL:MethylDackel              -
[-        ] process &gt; CALL:conversion_rate_estima... -

Pipeline execution summary
---------------------------
Name         : infallible_mccarthy
Profile      : test,singularity
Launch dir   : /gscratch/srlab/sam/analyses/20220710-olu-epidiverse_wgbs-test
Work dir     : /gscratch/srlab/sam/analyses/20220710-olu-epidiverse_wgbs-test/work
Status       : failed
Error report : Error executing process &gt; 'WGBS:read_trimming (sampleA)'

Caused by:
  Process `WGBS:read_trimming (sampleA)` terminated with an error exit status (1)

Command executed:

  mkdir fastq fastq/logs
  cutadapt -j 2 -a AGATCGGAAGAGC -A AGATCGGAAGAGC \
  -q 20 -m 36 -O 3 \
  -o fastq/merge.null \
  -p fastq/merge.g null g \
  &gt; fastq/logs/cutadapt.sampleA.merge.log 2&gt;&amp;1

Command exit status:
  1

Command output:
  (empty)

Work dir:
  /gscratch/srlab/sam/analyses/20220710-olu-epidiverse_wgbs-test/work/12/6ee9cc7a7372a97f34f21a4f79efb3

Tip: view the complete command output by changing to the process work dir and entering the command `cat .command.out`

Error executing process &gt; 'WGBS:read_trimming (sampleA)'

Caused by:
  Process `WGBS:read_trimming (sampleA)` terminated with an error exit status (1)

Command executed:

  mkdir fastq fastq/logs
  cutadapt -j 2 -a AGATCGGAAGAGC -A AGATCGGAAGAGC \
  -q 20 -m 36 -O 3 \
  -o fastq/merge.null \
  -p fastq/merge.g null g \
  &gt; fastq/logs/cutadapt.sampleA.merge.log 2&gt;&amp;1

Command exit status:
  1

Command output:
  (empty)

Work dir:
  /gscratch/srlab/sam/analyses/20220710-olu-epidiverse_wgbs-test/work/12/6ee9cc7a7372a97f34f21a4f79efb3

Tip: view the complete command output by changing to the process work dir and entering the command `cat .command.out`</code></pre>
<p>When I look at the Cutadapt log file, this is what is shown:</p>
<pre><code>cat cutadapt.sampleA.merge.log 
This is cutadapt 2.10 with Python 3.6.7
Command line parameters: -j 2 -a AGATCGGAAGAGC -A AGATCGGAAGAGC -q 20 -m 36 -O 3 -o fastq/merge.null -p fastq/merge.g null g
Processing reads on 2 cores in paired-end mode ...
ERROR: Traceback (most recent call last):
  File "/opt/conda/envs/wgbs/lib/python3.6/site-packages/cutadapt/pipeline.py", line 477, in run
    with xopen(self.file, 'rb') as f:
  File "/opt/conda/envs/wgbs/lib/python3.6/site-packages/xopen/__init__.py", line 407, in xopen
    return open(filename, mode)
IsADirectoryError: [Errno 21] Is a directory: 'null'

ERROR: Traceback (most recent call last):
  File "/opt/conda/envs/wgbs/lib/python3.6/site-packages/cutadapt/pipeline.py", line 477, in run
    with xopen(self.file, 'rb') as f:
  File "/opt/conda/envs/wgbs/lib/python3.6/site-packages/xopen/__init__.py", line 407, in xopen
    return open(filename, mode)
IsADirectoryError: [Errno 21] Is a directory: 'null'

ERROR: Traceback (most recent call last):
  File "/opt/conda/envs/wgbs/lib/python3.6/site-packages/cutadapt/pipeline.py", line 540, in run
    raise e
IsADirectoryError: [Errno 21] Is a directory: 'null'

Traceback (most recent call last):
  File "/opt/conda/envs/wgbs/bin/cutadapt", line 10, in &lt;module&gt;
    sys.exit(main())
  File "/opt/conda/envs/wgbs/lib/python3.6/site-packages/cutadapt/__main__.py", line 855, in main
    stats = r.run()
  File "/opt/conda/envs/wgbs/lib/python3.6/site-packages/cutadapt/pipeline.py", line 770, in run
    raise e
IsADirectoryError: [Errno 21] Is a directory: 'null'</code></pre>
<p>I <a href="https://github.com/EpiDiverse/wgbs/issues/8">posted an Issue</a>, but I’m not really expecting to get a response.</p>
<hr>
<p>20220709</p>
<ul>
<li><p>Nextflow epidiverse/snp: Let it run overnight and woke up to the same timeout error message and kernel memory warnings, despite changes in config file.. Although, I had been running it with the <code>-resume</code> flag… I’ll remove all previous <code>snps/</code> and <code>work/</code> dirs and run with the following command:</p>
<pre class="shell"><code>NXF_VER=20.07.1 /home/shared/nextflow run epidiverse/snp \
-c nextflow-docker_permissions.config \
-profile docker \
--input /home/shared/8TB_HDD_01/sam/data/O_lurida/BSseq/ \
--reference /home/shared/8TB_HDD_01/sam/data/O_lurida/genomes/Olurida_v081.fa</code></pre>
<ul>
<li>Well that didn’t work… I’m going to try again with a limited data set, as the <code>Olurida_v081.fa</code> has a TON of contigs, which has caused issues with other bisfulfite analysis software.</li>
</ul></li>
</ul>
<hr>
<p>20220708</p>
<ul>
<li><p>Spent time at Science Hour with Steven visualizing some of the <a href="http://en.wikipedia.org/wiki/Pacific_oyster"><em>Ostrea lurida</em> (Olympia oyster)</a> transcript counts stats in R - I mostly just watched and nodded. :)</p></li>
<li><p>Nextflow epidiverse/snp problems. Got to deal with these shenanigans:</p>
<pre class="shell"><code>================================================
E P I D I V E R S E - S N P    P I P E L I N E
================================================
~ version 1.0

input dir     : /home/shared/8TB_HDD_01/sam/data/O_lurida/BSseq/
reference     : /home/shared/8TB_HDD_01/sam/data/O_lurida/genomes/Olurida_v081.fa
output dir    : snps
variant calls : enabled
clustering    : enabled

================================================
RUN NAME: nostalgic_bhabha

executor &gt;  local (34)
[d7/390a8d] process &gt; SNPS:preprocessing (zr1394_all_s456_trimmed_bismark_bt2.deduplicated.sorted)     [100%] 10 of 10 ✔
[49/25512a] process &gt; SNPS:masking (zr1394_11_s456_trimmed_bismark_bt2.deduplicated.sorted - variants) [ 60%] 24 of 40, failed: 24, retries: 20
[-        ] process &gt; SNPS:extracting                                                                  -
[-        ] process &gt; SNPS:khmer                                                                       -
[-        ] process &gt; SNPS:kwip                                                                        -
[-        ] process &gt; SNPS:clustering                                                                  -
[-        ] process &gt; SNPS:sorting                                                                     -
[-        ] process &gt; SNPS:freebayes                                                                   -
[-        ] process &gt; SNPS:bcftools                                                                    -
[-        ] process &gt; SNPS:plot_vcfstats                                                               -
Error executing process &gt; 'SNPS:masking (zr1394_17_s456_trimmed_bismark_bt2.deduplicated.sorted - clustering)'

Caused by:
  Process exceeded running time limit (4h)

Command executed:

  change_sam_queries.py -Q -T 16 -t . -G calmd.bam clustering.bam || exit $?
  find -mindepth 1 -maxdepth 1 -type d -exec rm -r {} \;

Command exit status:
  -

Command output:
  (empty)

Command error:
  WARNING: Your kernel does not support swap limit capabilities or the cgroup is not mounted. Memory limited without swap.

Work dir:
  /home/shared/8TB_HDD_01/sam/analyses/20220707-olur-epidiverse/work/8b/636e263c8924aa275cd5f1fc7787e8

Tip: you can try to figure out what's wrong by changing to the process work dir and showing the script file named `.command.sh`</code></pre>
<ul>
<li><p>Updated custom config file (which was originally used solely to address permissions issues on the outptut files generated by the Docker container) to include improved time limits:</p>
<pre><code>  docker {
  fixOwnership = true
}


process {

    // Process-specific resource requirements
    withLabel:process_low {
        time   = 30.d
    }
    withLabel:process_medium {
        time   = 30.d
    }
    withLabel:process_high {
        time   = 30.d
    }
    withLabel:process_long {
        time   = 30.d
    }
}</code></pre></li>
<li><p>Seemed to fix timeout issue as this ran for nearly 6hrs without timing out error, but still getting the kernel memory warning in log files and constant failures at the masking step. Added this line to config file:</p>
<pre><code>docker.runOptions = "--memory-swap '-1'"</code></pre>
<p>Config file now looks like this (<a href="https://github.com/nf-core/tools/pull/351">grabbed idea to use this line to resolve kernel issue from here</a>):</p>
<pre><code>     docker {
         docker.runOptions = "--memory-swap '-1'"
         fixOwnership = true
 }


 process {

     // Process-specific resource requirements
     withLabel:process_low {
         time   = 30.d
     }
     withLabel:process_medium {
         time   = 30.d
     }
     withLabel:process_high {
         time   = 30.d
     }
     withLabel:process_long {
         time   = 30.d
     }
 }</code></pre></li>
</ul></li>
</ul>
<hr>
<p>20220707</p>
<ul>
<li><p>In order to start Nextflow epidiverse/snp, genome FastA file requires FastA index file; this is not documented, but pipeline throws an error when a FastA index is not found.</p></li>
<li><p>started Nextflow epidiverse/snp on raven</p></li>
</ul>
<hr>
<p>20220706</p>
<ul>
<li><p>fixed <a href="https://github.com/RobertsLab/resources/issues/1488">Nextflow epidiverse/snp problem</a> (GitHub Issue)</p></li>
<li><p>dealt with <a href="https://github.com/RobertsLab/resources/issues/1482">lake trout BioProject PRJNA316738 data retrieval and QC</a> (GitHub Issue)</p></li>
</ul>
<hr>
<p>20220705</p>
<ul>
<li><p>CEABIGR meeting:</p>
<ul>
<li>added gene names to transcript counts files</li>
<li>added code to cover all desired iterations of output files (i.e.&nbsp;missing controls males files)</li>
</ul></li>
</ul>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>