<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2020-03-30">

<title>robertslab.info - RNAseq Reads Extractions - C.bairdi Taxonomic Reads Extractions with MEGAN6 on swoose</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">robertslab.info</span>
    </a>
  </div>
          <div class="quarto-toggle-container ms-auto">
              <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
          </div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">RNAseq Reads Extractions - C.bairdi Taxonomic Reads Extractions with MEGAN6 on swoose</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Miscellaneous</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">March 30, 2020</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p><a href="https://robertslab.github.io/sams-notebook/2020/03/18/Transcriptome-Annotation-C.bairdi-Using-DIAMOND-BLASTx-on-Mox-and-MEGAN6-Meganizer-on-swoose.html">I previously annotated reads and converted them to the MEGAN6 format RMA6 on 20200318</a>.</p>
<p>I’ll use the MEGAN6 GUI to “Open” the RMA6 file. Once the file loads, you get a nice looking taxonomic tree! From here, you can select any part of the taxonomic tree by right-clicking on the desired taxonomy and “Extract reads…”. Here, you have the option to include “Summarized reads”. This option allows you to extract just the reads that are part of the exact classification you’ve selected or all those within and “below” the classification you’ve selected (i.e.&nbsp;summarized reads).</p>
<p>Extracted reads will be generated as FastA files.</p>
<p>Example:</p>
<p>If you select <em>Arthropoda</em> and <em>do not</em> check the box for “Summarized Reads” you will <em>only get reads classified as Arthropoda</em>! You will not get any reads with more specific taxonomies. However, if you select <em>Arthropoda</em> and you <em>do</em> check the box for “Summarized Reads”, you will get all reads classified as <em>Arthropoda</em> <em>AND</em> all reads in more specific taxonomic classifications, down to the species level.</p>
<p>I will extract reads from two phyla:</p>
<ul>
<li><p><em>Arthropoda</em> (for crabs)</p></li>
<li><p><em>Alveolata</em> (for <em>Hematodinium</em>)</p></li>
</ul>
<p>After read extractions using MEGAN6, I’ll need to extract the actual reads from the trimmed FastQ files. This will actually entail extracting all trimmed reads from two different sets of RNAseq:</p>
<ul>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20191218_cbai_fastp_RNAseq_trimming/">20191218_cbai_fastp_RNAseq_trimming/</a></p></li>
<li><p><a href="https://gannet.fish.washington.edu/Atumefaciens/20200318_cbai_RNAseq_fastp_trimming/">20200318_cbai_RNAseq_fastp_trimming/</a></p></li>
</ul>
<p>It’s a bit convoluted, but I realized that the FastA headers were incomplete and did not distinguish between paired reads. Here’s an example:</p>
<p>R1 FastQ header:</p>
<p><code>@A00147:37:HG2WLDMXX:1:1101:5303:1000 1:N:0:AGGCGAAG+AGGCGAAG</code></p>
<p>R2 FastQ header:</p>
<p><code>@A00147:37:HG2WLDMXX:1:1101:5303:1000 2:N:0:AGGCGAAG+AGGCGAAG</code></p>
<p>However, the reads extracted via MEGAN have FastA headers like this:</p>
<pre><code>&gt;A00147:37:HG2WLDMXX:1:1101:5303:1000
SEQUENCE1
&gt;A00147:37:HG2WLDMXX:1:1101:5303:1000
SEQUENCE2</code></pre>
<p>Those are a set of paired reads, but there’s no way to distinguish between R1/R2. This may not be an issue, but I’m not sure how downstream programs (i.e.&nbsp;Trinity) will handle duplicate FastA IDs as inputs. To avoid any headaches, I’ve decided to parse out the corresponding FastQ reads which have the full header info.</p>
<p>Here’s a brief rundown of the approach:</p>
<ol type="1">
<li><p>Create list of unique read headers from MEGAN6 FastA files.</p></li>
<li><p>Use list with <code>seqtk</code> program to pull out corresponding FastQ reads from the trimmed FastQ R1 and R2 files.</p></li>
</ol>
<p>This aspect of read extractions/concatenations is documented in the following Jupyter notebook (GitHub):</p>
<ul>
<li><a href="https://github.com/RobertsLab/code/blob/master/notebooks/sam/20200330_swoose_cbai_megan_read_extractions.ipynb">20200330_swoose_cbai_megan_read_extractions.ipynb</a></li>
</ul>
<hr>
<section id="results" class="level4">
<h4 class="anchored" data-anchor-id="results">RESULTS</h4>
<p>OUTPUT FOLDERS</p>
<p>Initial reads extracted as FastAs:</p>
<ul>
<li><a href="https://gannet.fish.washington.edu/Atumefaciens/20200323_cbai_MEGAN_read_extractions/">20200323_cbai_MEGAN_read_extractions/</a></li>
</ul>
<p>FastQ <em>C.bairdi</em> read extractions:</p>
<ul>
<li><a href="https://gannet.fish.washington.edu/Atumefaciens/20200330.C_bairdi_megan_reads">20200330.C_bairdi_megan_reads/</a></li>
</ul>
<p>FastQ <em>Hematodinium</em> read extractions:</p>
<ul>
<li><a href="https://gannet.fish.washington.edu/Atumefaciens/20200330.Hematodinium_megan_reads">20200330.Hematodinium_megan_reads</a></li>
</ul>
<p>The taxonomic tree from each MEGAN6 RMA6 file is shown below. There are a couple of interesting things to notice from these:</p>
<ol type="1">
<li><p>Some samples have a high abundance of reads assigned to <em>Bacteria</em>. My guess is that this was due to a slight misstep in sampling, leading to collecting mostly sea water instead of mostly hemolymph. I say this because in these samples, there are still a large amount of <em>Arthropoda</em> reads, so it’s clear that some hemolymph was collected.</p></li>
<li><p>Most samples which should have reads assigned to <em>Hematodinium</em> (<a href="https://docs.google.com/spreadsheets/d/1hXMY1rg5qYNTsqvO7PXbRgM7LF06ntEp27N2Efc9gSo/edit?usp=sharing">18 samples were considered “infected” via qPCR</a>) do not have <em>any</em> reads assigned. In fact, only four samples ended up having <em>Hematodinium</em> reads extracted:</p></li>
</ol>
<ul>
<li><p>132</p></li>
<li><p>178</p></li>
<li><p>349</p></li>
<li><p>485</p></li>
</ul>
<p>At this point in time, it’s not that big of a deal, since we’re currently just using this data to create an updated transcriptome for each of the two phyla.</p>
<ol start="3" type="1">
<li>Many (most?) of the samples had a relatively high abundance of reads assigned to a microsporidian, <em>Enterospora canceri</em>, a known crab parasite. This is intriguing and not entirely sure what the implications are for analyzing the crab gene expression are. Also, it might be interesting to try to extract these reads and assemble a <em>Enterospora canceri</em> transcriptome…</li>
</ol>
<p>Next up, creating some updated transcriptome assemblies/annotations for these two phyla.</p>
<hr>
</section>
<section id="taxonomic-trees" class="level4">
<h4 class="anchored" data-anchor-id="taxonomic-trees">Taxonomic Trees</h4>
<section id="section" class="level5">
<h5 class="anchored" data-anchor-id="section">113</h5>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://github.com/RobertsLab/sams-notebook/blob/master/images/screencaps/20200323_cbai_MEGAN_read_extractions_113.png?raw=true" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">113 MEGAN6 taxonomic tree</figcaption><p></p>
</figure>
</div>
<hr>
</section>
<section id="section-1" class="level5">
<h5 class="anchored" data-anchor-id="section-1">118</h5>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://github.com/RobertsLab/sams-notebook/blob/master/images/screencaps/20200323_cbai_MEGAN_read_extractions_118.png?raw=true" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">118 MEGAN6 taxonomic tree</figcaption><p></p>
</figure>
</div>
<hr>
</section>
<section id="section-2" class="level5">
<h5 class="anchored" data-anchor-id="section-2">127</h5>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://github.com/RobertsLab/sams-notebook/blob/master/images/screencaps/20200323_cbai_MEGAN_read_extractions_127.png?raw=true" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">127 MEGAN6 taxonomic tree</figcaption><p></p>
</figure>
</div>
<hr>
</section>
<section id="section-3" class="level5">
<h5 class="anchored" data-anchor-id="section-3">132</h5>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://github.com/RobertsLab/sams-notebook/blob/master/images/screencaps/20200323_cbai_MEGAN_read_extractions_132.png?raw=true" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">132 MEGAN6 taxonomic tree</figcaption><p></p>
</figure>
</div>
<hr>
</section>
<section id="section-4" class="level5">
<h5 class="anchored" data-anchor-id="section-4">151</h5>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://github.com/RobertsLab/sams-notebook/blob/master/images/screencaps/20200323_cbai_MEGAN_read_extractions_151.png?raw=true" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">151 MEGAN6 taxonomic tree</figcaption><p></p>
</figure>
</div>
<hr>
</section>
<section id="section-5" class="level5">
<h5 class="anchored" data-anchor-id="section-5">173</h5>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://github.com/RobertsLab/sams-notebook/blob/master/images/screencaps/20200323_cbai_MEGAN_read_extractions_173.png?raw=true" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">173 MEGAN6 taxonomic tree</figcaption><p></p>
</figure>
</div>
<hr>
</section>
<section id="section-6" class="level5">
<h5 class="anchored" data-anchor-id="section-6">178</h5>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://github.com/RobertsLab/sams-notebook/blob/master/images/screencaps/20200323_cbai_MEGAN_read_extractions_178.png?raw=true" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">178 MEGAN6 taxonomic tree</figcaption><p></p>
</figure>
</div>
<hr>
</section>
<section id="section-7" class="level5">
<h5 class="anchored" data-anchor-id="section-7">221</h5>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://github.com/RobertsLab/sams-notebook/blob/master/images/screencaps/20200323_cbai_MEGAN_read_extractions_221.png?raw=true" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">221 MEGAN6 taxonomic tree</figcaption><p></p>
</figure>
</div>
<hr>
</section>
<section id="section-8" class="level5">
<h5 class="anchored" data-anchor-id="section-8">222</h5>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://github.com/RobertsLab/sams-notebook/blob/master/images/screencaps/20200323_cbai_MEGAN_read_extractions_222.png?raw=true" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">222 MEGAN6 taxonomic tree</figcaption><p></p>
</figure>
</div>
<hr>
</section>
<section id="section-9" class="level5">
<h5 class="anchored" data-anchor-id="section-9">254</h5>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://github.com/RobertsLab/sams-notebook/blob/master/images/screencaps/20200323_cbai_MEGAN_read_extractions_254.png?raw=true" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">254 MEGAN6 taxonomic tree</figcaption><p></p>
</figure>
</div>
<hr>
</section>
<section id="section-10" class="level5">
<h5 class="anchored" data-anchor-id="section-10">272</h5>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://github.com/RobertsLab/sams-notebook/blob/master/images/screencaps/20200323_cbai_MEGAN_read_extractions_272.png?raw=true" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">272 MEGAN6 taxonomic tree</figcaption><p></p>
</figure>
</div>
<hr>
</section>
<section id="section-11" class="level5">
<h5 class="anchored" data-anchor-id="section-11">280</h5>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://github.com/RobertsLab/sams-notebook/blob/master/images/screencaps/20200323_cbai_MEGAN_read_extractions_280.png?raw=true" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">280 MEGAN6 taxonomic tree</figcaption><p></p>
</figure>
</div>
<hr>
</section>
<section id="section-12" class="level5">
<h5 class="anchored" data-anchor-id="section-12">294</h5>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://github.com/RobertsLab/sams-notebook/blob/master/images/screencaps/20200323_cbai_MEGAN_read_extractions_294.png?raw=true" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">294 MEGAN6 taxonomic tree</figcaption><p></p>
</figure>
</div>
<hr>
</section>
<section id="section-13" class="level5">
<h5 class="anchored" data-anchor-id="section-13">334</h5>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://github.com/RobertsLab/sams-notebook/blob/master/images/screencaps/20200323_cbai_MEGAN_read_extractions_334.png?raw=true" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">334 MEGAN6 taxonomic tree</figcaption><p></p>
</figure>
</div>
<hr>
</section>
<section id="section-14" class="level5">
<h5 class="anchored" data-anchor-id="section-14">349</h5>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://github.com/RobertsLab/sams-notebook/blob/master/images/screencaps/20200323_cbai_MEGAN_read_extractions_349.png?raw=true" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">349 MEGAN6 taxonomic tree</figcaption><p></p>
</figure>
</div>
<hr>
</section>
<section id="section-15" class="level5">
<h5 class="anchored" data-anchor-id="section-15">359</h5>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://github.com/RobertsLab/sams-notebook/blob/master/images/screencaps/20200323_cbai_MEGAN_read_extractions_359.png?raw=true" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">359 MEGAN6 taxonomic tree</figcaption><p></p>
</figure>
</div>
<hr>
</section>
<section id="section-16" class="level5">
<h5 class="anchored" data-anchor-id="section-16">425</h5>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://github.com/RobertsLab/sams-notebook/blob/master/images/screencaps/20200323_cbai_MEGAN_read_extractions_425.png?raw=true" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">425 MEGAN6 taxonomic tree</figcaption><p></p>
</figure>
</div>
<hr>
</section>
<section id="section-17" class="level5">
<h5 class="anchored" data-anchor-id="section-17">427</h5>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://github.com/RobertsLab/sams-notebook/blob/master/images/screencaps/20200323_cbai_MEGAN_read_extractions_427.png?raw=true" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">427 MEGAN6 taxonomic tree</figcaption><p></p>
</figure>
</div>
<hr>
</section>
<section id="section-18" class="level5">
<h5 class="anchored" data-anchor-id="section-18">445</h5>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://github.com/RobertsLab/sams-notebook/blob/master/images/screencaps/20200323_cbai_MEGAN_read_extractions_445.png?raw=true" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">445 MEGAN6 taxonomic tree</figcaption><p></p>
</figure>
</div>
<hr>
</section>
<section id="section-19" class="level5">
<h5 class="anchored" data-anchor-id="section-19">463</h5>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://github.com/RobertsLab/sams-notebook/blob/master/images/screencaps/20200323_cbai_MEGAN_read_extractions_463.png?raw=true" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">463 MEGAN6 taxonomic tree</figcaption><p></p>
</figure>
</div>
<hr>
</section>
<section id="section-20" class="level5">
<h5 class="anchored" data-anchor-id="section-20">481</h5>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://github.com/RobertsLab/sams-notebook/blob/master/images/screencaps/20200323_cbai_MEGAN_read_extractions_481.png?raw=true" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">481 MEGAN6 taxonomic tree</figcaption><p></p>
</figure>
</div>
<hr>
</section>
<section id="section-21" class="level5">
<h5 class="anchored" data-anchor-id="section-21">485</h5>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://github.com/RobertsLab/sams-notebook/blob/master/images/screencaps/20200323_cbai_MEGAN_read_extractions_485.png?raw=true" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">485 MEGAN6 taxonomic tree</figcaption><p></p>
</figure>
</div>
<hr>
</section>
<section id="section-22" class="level5">
<h5 class="anchored" data-anchor-id="section-22">72</h5>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://github.com/RobertsLab/sams-notebook/blob/master/images/screencaps/20200323_cbai_MEGAN_read_extractions_72.png?raw=true" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">72 MEGAN6 taxonomic tree</figcaption><p></p>
</figure>
</div>
<hr>
</section>
<section id="section-23" class="level5">
<h5 class="anchored" data-anchor-id="section-23">73</h5>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://github.com/RobertsLab/sams-notebook/blob/master/images/screencaps/20200323_cbai_MEGAN_read_extractions_73.png?raw=true" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">73 MEGAN6 taxonomic tree</figcaption><p></p>
</figure>
</div>
<hr>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>